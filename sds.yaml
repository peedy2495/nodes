infra:
  os-installation:
    node-general:
      repositories:
        filesystems:
          method: add
          exec: transactional-update -i run bash -c 'zypper ar -cfp 90 https://download.opensuse.org/repositories/filesystems/openSUSE_Tumbleweed/filesystems.repo; zypper --gpg-auto-import-keys refresh'
    node-n0:
      packages:
        filesystems:
          exec: transactional-update pkg install -y xfsprogs lizardfs-adm lizardfs-master lizardfs-chunkserver lizardfs-client lizardfs-metalogger
      storage:
        sda:
          partition-table:
            new: gpt
          partition:
            1:
              - max size
              - remove signature (if asked)
        sda1:
          format:
            fstype: xfs
            uuid: 45a882b7-a032-4f87-acf4-36ecaca9d554
          mount:
            path: /var/lib/mfs/drives/sda1
            ownership: mfs:mfs
            fstab-entry: UUID=45a882b7-a032-4f87-acf4-36ecaca9d554 /var/lib/mfs/drives/sda1 xfs rw,noexec,nodev,noatime,nodiratime,largeio,inode64 0 0
      setup:
        lizardfs:
          master:
            files:
              metadata.mfs:
                path: /var/lib/mfs
                ownership: mfs:mfs
                content: 
                  - 'MFSM NEW'
              mfsmaster.cfg:
                path: /etc/mfs
                copyof: mfsmaster.cfg.dist
                content:
                  - PERSONALITY = master
                  - ADMIN_PASSWORD = bofh
                  - WORKING_USER = mfs
                  - WORKING_GROUP = mfs
              mfsexports.cfg:
                path: /etc/mfs
                copyof: mfsexports.cfg.dist
                content: no changes